/*! zollty-tmpl.js v1.3.2 - https://github.com/zollty-org/zollty-tmpl/ */!function(a,b){"object"==typeof exports&&exports?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.zollty={})}(this,function(a){function l(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function D(a){return a.replace(x,"").replace(y,",").replace(z,"").replace(A,"").replace(B,"").split(C)}a.version="1.3.2";var b=a.settings={tags:["{{","}}"],escape:!0,cache:!0,compress:!1},c=function(a){var b=void 0!==window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest;b.open("GET",a,!1);try{b.send(null)}catch(c){return null}return 404==b.status||2==b.status||0==b.status&&""==b.responseText?null:b.responseText},d=function(a,b){for(var c=0;c<a.length;c++)if(a.charAt(c)===b)return!0;return!1},e={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},f=function(a){return e[a]},g=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?g(a.call(a)):""),a},h=function(a){return-1!=a.indexOf("?")?a+"&t="+(new Date).getTime():a+"?t="+(new Date).getTime()},i=function(a){return g(a).replace(/&(?![\w#]+;)|[<>"']/g,f)},j=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},k=function(a,b){var c,d;if(j(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)};a.config=function(a,c){b[a]=c},a.errorLog=function(a){var b=a.name||"Template error";b+="\n\n",a.message&&(b+=a.message+"\n\n");for(var c in a)"message"!=c&&(b+="<"+c+">\n"+a[c]+"\n\n");"object"==typeof console&&console.error(b)};var m=function(b){a.errorLog(b);var c=b.name||"Template error";return function(){return"{"+c+(b.message?": "+b.message:"")+". See the console log for details.}"}},n=a.renderCache={};a.getRender=function(a,b){var e;if(n[a])e=n[a];else if(d(a,"/")){b&&(a=h(a));var f=c(a);f&&(e=s(f,{filename:a}))}else if("object"==typeof document){var g=document.getElementById(a);if(g){var f=(g.value||g.innerHTML).replace(/^\s*|\s*$/g,"");e=s(f,{filename:a})}}return e||m({filename:a,name:"Error",message:"Template not found"})};var o=a.render=function(b,c){var d=a.getRender(b);return c?d(c):d};a.renderN=function(b,c){var d=a.getRender(b,!0);return c?d(c):d};var q={$include:o,$escape:i,$each:k,$extFns:{}};a.extend=function(a){for(var b in a)q.$extFns[b]=a[b]};var r=a.compile=function(a,c){if(void 0===a||null===a||""===a)throw{name:"Error",message:"Template is null or empty"};c=c||{};for(var d in b)void 0===c[d]&&(c[d]=b[d]);return E(a,c)},s=a.createRender=function(a,b){var d,c=b.filename;try{d=r(a,b)}catch(e){return m(e)}var f=function(e){try{return new d(e,c)+""}catch(f){return b.debug?m(f)():(b.debug=!0,s(a,b)(e))}};return f.prototype=d.prototype,f.toString=function(){return d.toString()},c&&b.cache&&(n[c]=f),f},t=function(a,b){var e,c=b.shift(),d=b.join(" ").replace(/\s+/g,"");if("("===d.charAt(0)){d=d.substring(1,d.length-1);var f=d.split(",");e="{";for(var g=!0,h=0;h<f.length;h++)g?(e+="'"+f[h]+"':"+f[h],g=!1):e+=",'"+f[h]+"':"+f[h];e+="}"}else e=d;return""===e?a+"("+c+",$data);":a+"("+c+","+e+");"},u=function(a,b){var c=b.split(":"),d=c.shift();d=d.replace(/^\s/,"");var e=c.join(":")||"";return e&&(e=", "+e),"$extFns."+d+"("+a+e+")"},v=a.syntaxParser=function(a){a=a.replace(/^\s/,"");var c=a.split(" "),d=c.shift(),e=c.join(" ");switch(d){case"if":a="if("+e+"){";break;case"else":c="if"===c.shift()?" if("+c.join(" ")+")":"",a="}else"+c+"{";break;case"/if":a="}";break;case"each":var f=c[0]||"$data",g=c[1]||"as",h=c[2]||"$value",i=c[3]||"$index",j=h+","+i;"as"!==g&&(f="[]"),a="$each("+f+",function("+j+"){";break;case"/each":a="});";break;case"echo":a="print("+e+");";break;case"print":case"include":a=t(d,c);break;default:if(/^\s*\|\s*[\w\$]/.test(e)){var k=!0;"#"===a.charAt(0)&&(a=a.substr(1),k=!1);for(var l=0,m=a.split("|"),n=m.length,o=m[l++];n>l;l++)o=u(o,m[l]);a=(k?"=":"=#")+o}else a="="+a}return a},w="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",x=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,y=/[^\w$]+/g,z=new RegExp(["\\b"+w.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),A=/^\d[^,]*|,\d[^,]*/g,B=/^,+|,+$/g,C=/^$|,+/,E=function(a,b){function y(a){return h+=a.split(/\n/).length-1,f&&(a=a.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),a&&(a=m[1]+l(a)+m[2]+"\n"),a}function z(a){if(a=v(a,b),0===a.indexOf("=")){var d=g&&!/^=[=#]/.test(a);if(a=a.replace(/^=[=#]?|[\s;]*$/g,""),d){var e=a.replace(/\s*\([^\)]+\)/,"");q[e]||/^(include|print)$/.test(e)||(a="$escape("+a+")")}a=m[1]+a+m[2]}return c&&(a="$line="+h+";"+a),k(D(a),function(a){if(a&&!i[a]){var b;b="print"===a?o:"include"===a?p:q[a]?"$utils."+a:q.$extFns[a]?"$extFns."+a:"$data."+a,r+=a+"="+b+",",i[a]=!0}}),a+"\n"}var c=b.debug,d=b.tags[0],e=b.tags[1],f=b.compress,g=b.escape,h=1,i={$data:1,$filename:1,$utils:1,$extFns:1,$out:1,$line:1},j="".trim,m=j?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],n=j?"$out+=text;return $out;":"$out.push(text);",o="function(){var text=''.concat.apply('',arguments);"+n+"}",p="function(filename,data){data=data||$data;var text=$utils.$include(filename,data);"+n+"}",r="'use strict';var $utils=this,$extFns=$utils.$extFns,"+(c?"$line=0,":""),s=m[0],t="return new String("+m[3]+");";k(a.split(d),function(a){a=a.split(e);var b=a[0],c=a[1];1===a.length?s+=y(b):(s+=z(b),c&&(s+=y(c)))});var u=r+s+t;c&&(u="try{"+u+"}catch(e){"+"throw {"+"filename:$filename,"+"name:'Render error',"+"message:e.message,"+"line:$line,"+"source:"+l(a)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')"+"};"+"}");try{var w=new Function("$data","$filename",u);return w.prototype=q,w}catch(x){throw x.name="Syntax error",x.tmplFn="function anonymous($data,$filename) {"+u+"}",x}}});
